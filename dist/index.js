var e=require("react"),t=function(e){if(null==e)return null;try{return JSON.parse(e)}catch(e){return null}};exports.StorageService=function(){function e(e,r,n){var a=this;void 0===r&&(r=JSON.stringify),void 0===n&&(n=t),this._storage=e,this._serialize=r,this._deserialize=n,this.getData=function(e){return a.deserialize(a.storage.getItem(e))},this.removeData=function(e){a.storage.removeItem(e),a.raiseEvent({key:e,newValue:""})},this.setData=function(e,t){var r=a.serialize(t);a.storage.setItem(e,r),a.raiseEvent({key:e,newValue:r})},this.subscribe=function(e){var t=function(t){return null==e?void 0:e({storageArea:t.storageArea,key:t.key,newValue:t.newValue})};return window.addEventListener("storage",t),function(){return window.removeEventListener("storage",t)}}}var r;return e.prototype.raiseEvent=function(e){window.dispatchEvent(new StorageEvent("storage",{key:e.key,newValue:e.newValue,storageArea:this.storage}))},(r=[{key:"deserialize",get:function(){return this._deserialize}},{key:"serialize",get:function(){return this._serialize}},{key:"storage",get:function(){return this._storage}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,r),e}(),exports.createStorageHook=function(t){return function(r,n){void 0===n&&(n=null);var a=e.useState(function(){return t.getData(r)||n}),i=a[0],u=a[1],o=e.useCallback(function(e){u(function(n){var a=e instanceof Function?e(n):e;return t.setData(r,a),a})},[r]);return e.useEffect(function(){var e=t.getData(r);null!=n&&null===e&&t.setData(r,n)},[r]),e.useEffect(function(){var e=t.subscribe(function(e){e.storageArea===t.storage&&e.key===r&&u(t.deserialize(e.newValue))});return function(){return e()}},[r]),[i,o]}};
//# sourceMappingURL=index.js.map
